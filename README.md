# Playwright E2E тесты для Stack-IT (demo)

Автоматизированные UI/E2E тесты на **Playwright + TypeScript** для проверки сценариев в системе Stack-IT (демо-стенд).


## Что реализовано

- **Авторизация** (включая обработку возможного подтверждения входа)
- Переход в раздел **«Адресный фонд → Адреса проживающих»**
- CRUD для уровня **«Район»**:
    - открытие диалога создания
    - **добавление** записи
    - **редактирование** записи
    - **удаление** записи
- **Негативные проверки**:
    - валидация обязательных полей (название района, номер в списке)
    - проверка сообщения "Поле не может быть пустым"
    - валидация типа данных (поле "Номер в списке" принимает только цифры)
    - проверка отклонения нецифровых символов (буквы, спецсимволы)
    - проверка состояния кнопки "Сохранить" при невалидных данных
- **Поиск записи с учётом пагинации**:
    - сначала проверяется текущая страница
    - при необходимости выполняется перебор страниц
- **Стабилизация UI**:
    - дополнительные ожидания для кликабельности элементов (оверлеи/анимации)
    - `workers=1` (для стабильности сессии на демо-аккаунте)
- **CI в GitHub Actions**:
    - сохранение HTML отчёта Playwright и артефактов (скриншоты при падении)
    - запуск по тегам (`@smoke`, `@regression`, `@critical`, `@e2e`, `@negative`)

### Итог (15 тестов)
- ✅ Полный `@e2e` сценарий для записи **«Район»** - 1 тест
- ✅ Авторизация - 1 тест
- ✅ Smoke-проверки - 3 теста
- ✅ Regression-провреки - 3 теста
- ✅ Негативные сценарии для регресса - 7 тестов

## Важная особенность: идентификация записей

Названия/некоторые поля в таблице могут быть неуникальными, поэтому созданная запись идентифицируется по **ID**, полученному из backend-запроса при сохранении (перехват network request).

## Переменные окружения


- В CI значения задаются через GitHub Secrets: `STACK_LOGIN`, `STACK_PASSWORD`.
- Для локального запуска необходим файл `.env` в корне проекта:

```env
STACK_LOGIN=...
STACK_PASSWORD=...
```

## Установка

```bash
npm ci
npx playwright install
```

## Запуск тестов

```bash
# Все тесты
npx playwright test
# Smoke
npx playwright test -g "@smoke"
# Regression
npx playwright test -g "@regression"
# В одном браузере
npx playwright test --project=chromium
# Список тестов без запуска
npx playwright test --list
```
## Отчёты

После запуска тестов HTML-отчёт доступен командой:
```bash
npx playwright show-report
```

В CI отчёты доступны во вкладке **Actions → Artifacts** (папка `playwright-report` содержит `index.html`).

## Векторы развития
- Добавить более детализированные **Allure-отчеты** вместо стоковых `playwright-report`
- Покрыть тестами пагинацию и фильтры на странице с таблицей записей
- Покрыть тестами дополнительные параметры в записи **«Район»**
- Улучшить стабильность тестов на демо-стенде

